make.file(inputdir=mothurfolder, type=fastq, prefix=conn)
make.contigs(file=conn.files, processors=4)
summary.seqs(fasta=conn.trim.contigs.fasta)
screen.seqs(fasta=conn.trim.contigs.fasta, group=conn.contigs.groups, maxambig=0, maxlength=275)
unique.seqs(fasta=conn.trim.contigs.good.fasta)
count.seqs(name=conn.trim.contigs.good.names, group=conn.contigs.good.groups)
summary.seqs(count=conn.trim.contigs.good.count_table)
pcr.seqs(fasta=silva.nr_v128.align, start=11894, end=25319, keepdots=F, processors=4)
align.seqs(fasta=conn.trim.contigs.good.unique.fasta, reference=silva.nr_v128.pcr.align)
summary.seqs(fasta=conn.trim.contigs.good.unique.align, count=conn.trim.contigs.good.count_table)
screen.seqs(fasta=conn.trim.contigs.good.unique.align, count=conn.trim.contigs.good.count_table, summary=conn.trim.contigs.good.unique.summary, start=1968, end=11550, maxhomop=8)
summary.seqs(fasta=current, count=current)
filter.seqs(fasta=conn.trim.contigs.good.unique.good.align, vertical=T, trump=.)
unique.seqs(fasta=conn.trim.contigs.good.unique.good.filter.fasta, count=conn.trim.contigs.good.good.count_table)
pre.cluster(fasta=conn.trim.contigs.good.unique.good.filter.unique.fasta,count=conn.trim.contigs.good.unique.good.filter.count_table, diffs=2)
chimera.vsearch(fasta=conn.trim.contigs.good.unique.good.filter.unique.precluster.fasta, count=conn.trim.contigs.good.unique.good.filter.unique.precluster.count_table, dereplicate=t)
remove.seqs(fasta=conn.trim.contigs.good.unique.good.filter.unique.precluster.fasta, accnos=conn.trim.contigs.good.unique.good.filter.unique.precluster.denovo.vsearch.accnos)
summary.seqs(fasta=current, count=current)
classify.seqs(fasta=conn.trim.contigs.good.unique.good.filter.unique.precluster.pick.fasta, count=conn.trim.contigs.good.unique.good.filter.unique.precluster.denovo.vsearch.pick.count_table, reference=silva.nr_v128.align, taxonomy=silva.nr_v128.tax, cutoff=80)
remove.lineage(fasta=conn.trim.contigs.good.unique.good.filter.unique.precluster.pick.fasta, count=conn.trim.contigs.good.unique.good.filter.unique.precluster.denovo.vsearch.pick.count_table, taxonomy=conn.trim.contigs.good.unique.good.filter.unique.precluster.pick.nr_v128.wang.taxonomy, taxon=Chloroplast-Mitochondria-unknown-Archaea-Eukaryota)
summary.tax(taxonomy=current, count=current)
cluster.split(fasta=conn.trim.contigs.good.unique.good.filter.unique.precluster.pick.pick.fasta, count=conn.trim.contigs.good.unique.good.filter.unique.precluster.denovo.vsearch.pick.pick.count_table, taxonomy=conn.trim.contigs.good.unique.good.filter.unique.precluster.pick.nr_v128.wang.pick.taxonomy, splitmethod=average, taxlevel=4, cutoff=0.03)
make.shared(list=conn.trim.contigs.good.unique.good.filter.unique.precluster.pick.pick.opti_mcc.unique_list.list,  count=conn.trim.contigs.good.unique.good.filter.unique.precluster.denovo.vsearch.pick.pick.count_table, label=0.03)
classify.otu(list=conn.trim.contigs.good.unique.good.filter.unique.precluster.pick.pick.opti_mcc.unique_list.list, count=conn.trim.contigs.good.unique.good.filter.unique.precluster.denovo.vsearch.pick.pick.count_table, taxonomy=conn.trim.contigs.good.unique.good.filter.unique.precluster.pick.nr_v128.wang.pick.taxonomy, label=0.03)
dist.seqs(fasta=conn.trim.contigs.good.unique.good.filter.unique.precluster.pick.pick.fasta, output=lt, processors=2)
clearcut(phylip=conn.trim.contigs.good.unique.good.filter.unique.precluster.pick.pick.phylip.dist)

phylo.diversity(tree=conn.tre, count=conn.count_table, rarefy=T)
unifrac.unweighted(tree=conn.tre, count=conn.count_table, distance=lt, processors=2, random=F, subsample=T)
unifrac.weighted(tree=conn.tre, count=conn.count_table, distance=lt, processors=2, random=F, subsample=T)